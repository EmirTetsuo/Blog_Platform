{"ast":null,"code":"import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport axios from '../../../utils/axios';\nimport { useDispatch, useSelector } from 'react-redux';\nconst initialState = {\n  user: null,\n  token: null,\n  isLoading: false,\n  status: null,\n  users: []\n};\nexport const getAllUsers = createAsyncThunk('auth/getAllUsers', async () => {\n  try {\n    const {\n      data\n    } = await axios.get('/users');\n    console.log('API Response:', data); // Логируйте данные\n\n    return data;\n  } catch (error) {\n    console.error(error);\n  }\n});\nexport const registerUser = createAsyncThunk('auth/registerUser', async _ref => {\n  let {\n    username,\n    email,\n    password\n  } = _ref;\n\n  try {\n    const {\n      data\n    } = await axios.post('/auth/register', {\n      username,\n      email,\n      password\n    });\n\n    if (data.token) {\n      window.localStorage.setItem('token', data.token);\n    }\n\n    return data;\n  } catch (error) {\n    console.log(error);\n  }\n});\nexport const loginUser = createAsyncThunk('auth/loginUser', async _ref2 => {\n  let {\n    identifier,\n    password\n  } = _ref2;\n\n  try {\n    const {\n      data\n    } = await axios.post('/auth/login', {\n      identifier,\n      password\n    });\n\n    if (data.token) {\n      window.localStorage.setItem('token', data.token);\n    }\n\n    return data;\n  } catch (error) {\n    console.log(error);\n  }\n});\nexport const removeUser = createAsyncThunk('auth/removeUser', async id => {\n  try {\n    const {\n      data\n    } = await axios.delete(`/users/${id}`, id);\n    return data;\n  } catch (error) {\n    console.log(error);\n  }\n});\nexport const getMe = createAsyncThunk('auth/getMe', async () => {\n  try {\n    const {\n      data\n    } = await axios.get('/auth/me');\n    return data;\n  } catch (error) {\n    console.log(error);\n  }\n});\nexport const authSlice = createSlice({\n  name: 'auth',\n  initialState,\n  reducers: {\n    logout: state => {\n      state.user = null;\n      state.token = null;\n      state.isLoading = false;\n      state.status = null;\n    }\n  },\n  extraReducers: {\n    // Get all users\n    [getAllUsers.pending]: state => {\n      state.loading = true;\n    },\n    [getAllUsers.fulfilled]: (state, action) => {\n      state.loading = false;\n      state.users = action.payload.users;\n    },\n    [getAllUsers.rejected]: state => {\n      state.loading = false;\n    },\n    // Register user\n    [registerUser.pending]: state => {\n      state.isLoading = true;\n      state.status = null;\n    },\n    [registerUser.fulfilled]: (state, action) => {\n      state.isLoading = false;\n      state.status = action.payload.message;\n      state.user = action.payload.user;\n      state.token = action.payload.token;\n      state.users.push(action.payload);\n    },\n    [registerUser.rejected]: (state, action) => {\n      var _action$payload;\n\n      state.status = ((_action$payload = action.payload) === null || _action$payload === void 0 ? void 0 : _action$payload.message) || 'Registration failed';\n      state.isLoading = false;\n    },\n    // Login user\n    [loginUser.pending]: state => {\n      state.isLoading = true;\n      state.status = null;\n    },\n    [loginUser.fulfilled]: (state, action) => {\n      state.isLoading = false;\n      state.status = action.payload.message;\n      state.user = action.payload.user;\n      state.token = action.payload.token;\n      dispatch(getMe());\n    },\n    [loginUser.rejected]: (state, action) => {\n      var _action$payload2;\n\n      state.status = ((_action$payload2 = action.payload) === null || _action$payload2 === void 0 ? void 0 : _action$payload2.message) || 'Login failed';\n      state.isLoading = false;\n    },\n    // Check authorization\n    [getMe.pending]: state => {\n      state.isLoading = true;\n      state.status = null;\n    },\n    [getMe.fulfilled]: (state, action) => {\n      var _action$payload3, _action$payload4;\n\n      state.isLoading = false;\n      state.status = null;\n      state.user = (_action$payload3 = action.payload) === null || _action$payload3 === void 0 ? void 0 : _action$payload3.user;\n      state.token = (_action$payload4 = action.payload) === null || _action$payload4 === void 0 ? void 0 : _action$payload4.token;\n    },\n    [getMe.rejected]: (state, action) => {\n      var _action$payload5;\n\n      state.status = ((_action$payload5 = action.payload) === null || _action$payload5 === void 0 ? void 0 : _action$payload5.message) || 'Authorization check failed';\n      state.isLoading = false;\n    },\n    // удаление пользователя\n    [removeUser.pending]: state => {\n      state.loading = true;\n    },\n    [removeUser.fulfilled]: (state, action) => {\n      state.loading = false;\n      state.users = state.users.filter(user => user._id !== action.payload._id);\n    },\n    [removeUser.rejected]: state => {\n      state.loading = false;\n    }\n  }\n});\nexport const checkIsAuth = state => Boolean(state.auth.token);\nexport const {\n  logout\n} = authSlice.actions;\nexport default authSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","axios","useDispatch","useSelector","initialState","user","token","isLoading","status","users","getAllUsers","data","get","console","log","error","registerUser","username","email","password","post","window","localStorage","setItem","loginUser","identifier","removeUser","id","delete","getMe","authSlice","name","reducers","logout","state","extraReducers","pending","loading","fulfilled","action","payload","rejected","message","push","dispatch","filter","_id","checkIsAuth","Boolean","auth","actions","reducer"],"sources":["C:/Users/neo/Desktop/veb/23.02.23/js projects/blog-platform/frontend/src/redux/features/auth/authSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport axios from '../../../utils/axios';\nimport { useDispatch, useSelector } from 'react-redux';\n\nconst initialState = {\n    user: null,\n    token: null,\n    isLoading: false,\n    status: null,\n    users: [], \n};\n\n\nexport const getAllUsers = createAsyncThunk(\n    'auth/getAllUsers',\n    async () => {\n        try {\n            const { data } = await axios.get('/users');\n            console.log('API Response:', data); // Логируйте данные\n            return data;\n        } catch (error) {\n            console.error(error);\n        }\n    }\n);\n\n\nexport const registerUser = createAsyncThunk(\n    'auth/registerUser',\n    async ({ username, email, password }) => {\n        try {\n            const { data } = await axios.post('/auth/register', {\n                username,\n                email, \n                password,\n            });\n            if (data.token) {\n                window.localStorage.setItem('token', data.token);\n            }\n            return data;\n        } catch (error) {\n            console.log(error);\n        }\n    },\n);\n\nexport const loginUser = createAsyncThunk(\n    'auth/loginUser',\n    async ({ identifier, password }) => {\n        try {\n            const { data } = await axios.post('/auth/login', {\n                identifier, \n                password,\n            });\n            if (data.token) {\n                window.localStorage.setItem('token', data.token);\n            }\n            return data;\n        } catch (error) {\n            console.log(error);\n        }\n    },\n);\n\nexport const removeUser = createAsyncThunk('auth/removeUser', async (id) => {\n    try {\n        const { data } = await axios.delete(`/users/${id}`, id)\n        return data\n    } catch (error) {\n        console.log(error)\n    }\n})\n\nexport const getMe = createAsyncThunk('auth/getMe', async () => {\n    try {\n        const { data } = await axios.get('/auth/me');\n        return data;\n    } catch (error) {\n        console.log(error);\n    }\n});\n\nexport const authSlice = createSlice({\n    name: 'auth',\n    initialState,\n    reducers: {\n        logout: (state) => {\n            state.user = null;\n            state.token = null;\n            state.isLoading = false;\n            state.status = null;\n        },\n    },\n    extraReducers: {\n        // Get all users\n        [getAllUsers.pending]: (state) => {\n            state.loading = true\n        },\n        [getAllUsers.fulfilled]: (state, action) => {\n            state.loading = false\n            state.users = action.payload.users\n        },\n        [getAllUsers.rejected]: (state) => {\n            state.loading = false\n        },\n        // Register user\n        [registerUser.pending]: (state) => {\n            state.isLoading = true;\n            state.status = null;\n        },\n        [registerUser.fulfilled]: (state, action) => {\n            state.isLoading = false;\n            state.status = action.payload.message;\n            state.user = action.payload.user;\n            state.token = action.payload.token;\n            state.users.push(action.payload)\n        },\n        [registerUser.rejected]: (state, action) => {\n            state.status = action.payload?.message || 'Registration failed';\n            state.isLoading = false;\n        },\n        // Login user\n        [loginUser.pending]: (state) => {\n            state.isLoading = true;\n            state.status = null;\n        },\n        [loginUser.fulfilled]: (state, action) => {\n            state.isLoading = false;\n            state.status = action.payload.message;\n            state.user = action.payload.user;\n            state.token = action.payload.token;\n            dispatch(getMe()); \n        },\n        [loginUser.rejected]: (state, action) => {\n            state.status = action.payload?.message || 'Login failed';\n            state.isLoading = false;\n        },\n        // Check authorization\n        [getMe.pending]: (state) => {\n            state.isLoading = true;\n            state.status = null;\n        },\n        [getMe.fulfilled]: (state, action) => {\n            state.isLoading = false;\n            state.status = null;\n            state.user = action.payload?.user;\n            state.token = action.payload?.token;\n        },\n        [getMe.rejected]: (state, action) => {\n            state.status = action.payload?.message || 'Authorization check failed';\n            state.isLoading = false;\n        },\n        // удаление пользователя\n        [removeUser.pending]: (state) => {\n            state.loading = true\n        },\n        [removeUser.fulfilled]: (state, action) => {\n            state.loading = false\n            state.users = state.users.filter(\n                (user) => user._id !== action.payload._id,\n            )\n        },\n        [removeUser.rejected]: (state) => {\n            state.loading = false\n        },\n    },\n});\n\nexport const checkIsAuth = (state) => Boolean(state.auth.token);\n\nexport const { logout } = authSlice.actions;\nexport default authSlice.reducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}