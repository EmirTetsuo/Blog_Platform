{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\neo\\\\Desktop\\\\veb\\\\23.02.23\\\\Blog\\\\frontend\\\\src\\\\features\\\\PostItemContent.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport { FaVolumeUp, FaVolumeMute } from 'react-icons/fa';\nimport { useSelector } from 'react-redux';\nimport { FaPlay, FaPause } from 'react-icons/fa';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const PostItemContent = _ref => {\n  _s();\n\n  let {\n    post\n  } = _ref;\n  const user = useSelector(state => state.auth.user);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [isMuted, setIsMuted] = useState(false);\n  const API_URL = process.env.REACT_APP_API_URL;\n  const videoRef = useRef(null);\n\n  const togglePlayPause = () => {\n    if (isPlaying) {\n      videoRef.current.pause();\n    } else {\n      videoRef.current.play();\n    }\n\n    setIsPlaying(!isPlaying);\n  };\n\n  const toggleMute = () => {\n    setIsMuted(prev => !prev);\n    videoRef.current.muted = !isMuted;\n  };\n\n  const isVideo = url => {\n    const videoExtensions = ['.mp4', '.webm', '.ogg'];\n    return videoExtensions.some(ext => url.endsWith(ext));\n  };\n\n  useEffect(() => {\n    const videoElement = videoRef.current;\n    if (!videoElement) return;\n    const observer = new IntersectionObserver(entries => {\n      entries.forEach(entry => {\n        if (!entry.isIntersecting && !videoElement.paused) {\n          videoElement.pause();\n          setIsPlaying(false);\n        }\n      });\n    }, {\n      threshold: 0.5\n    } // 50% видео должно быть видно, чтобы считалось \"на экране\"\n    );\n    observer.observe(videoElement);\n    return () => {\n      observer.unobserve(videoElement);\n    };\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `${post.imgUrl && isVideo(post.imgUrl)} transition-all`,\n    children: post.imgUrl && isVideo(post.imgUrl) ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"relative group\",\n      children: [/*#__PURE__*/_jsxDEV(\"video\", {\n        ref: videoRef,\n        width: \"100%\",\n        height: \"100%\",\n        maxHeight: \"550px\",\n        muted: isMuted,\n        className: \"object-cover w-full\",\n        onLoadedData: () => {\n          videoRef.current.play();\n          setIsPlaying(true);\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"source\", {\n          src: `${API_URL}/${post.imgUrl}`,\n          type: \"video/mp4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 25\n        }, this), \"\\u0412\\u0430\\u0448 \\u0431\\u0440\\u0430\\u0443\\u0437\\u0435\\u0440 \\u043D\\u0435 \\u043F\\u043E\\u0434\\u0434\\u0435\\u0440\\u0436\\u0438\\u0432\\u0430\\u0435\\u0442 \\u0432\\u0438\\u0434\\u0435\\u043E.\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"absolute inset-0 flex justify-center items-center bg-black bg-opacity-30 group-hover:flex hidden\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: togglePlayPause,\n          className: \"text-white opacity-50 hover:opacity-75 transition\",\n          children: isPlaying ? /*#__PURE__*/_jsxDEV(FaPause, {\n            className: \"max-md:w-8 max-md:h-8 w-20 h-20\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 81,\n            columnNumber: 33\n          }, this) : /*#__PURE__*/_jsxDEV(FaPlay, {\n            className: \"max-md:w-8 max-md:h-8  w-20 h-20\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 33\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: toggleMute,\n        className: \"absolute bottom-4 right-4 p-2 bg-black bg-opacity-50 rounded-full text-white\",\n        children: isMuted ? /*#__PURE__*/_jsxDEV(FaVolumeMute, {\n          className: \"w-6 h-6\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 36\n        }, this) : /*#__PURE__*/_jsxDEV(FaVolumeUp, {\n          className: \"w-6 h-6\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 75\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 17\n    }, this) : /*#__PURE__*/_jsxDEV(\"img\", {\n      src: `${API_URL}/${post.imgUrl}`,\n      alt: \"Post content\",\n      className: \"object-cover w-full h-full max-md:max-h-[250px] max-h-[500px]\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 17\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 57,\n    columnNumber: 9\n  }, this);\n};\n\n_s(PostItemContent, \"obc2psRfhmFF/0cwuMkHTAAJsDs=\", false, function () {\n  return [useSelector];\n});\n\n_c = PostItemContent;\n\nvar _c;\n\n$RefreshReg$(_c, \"PostItemContent\");","map":{"version":3,"names":["React","useState","useEffect","useRef","FaVolumeUp","FaVolumeMute","useSelector","FaPlay","FaPause","PostItemContent","post","user","state","auth","isPlaying","setIsPlaying","isMuted","setIsMuted","API_URL","process","env","REACT_APP_API_URL","videoRef","togglePlayPause","current","pause","play","toggleMute","prev","muted","isVideo","url","videoExtensions","some","ext","endsWith","videoElement","observer","IntersectionObserver","entries","forEach","entry","isIntersecting","paused","threshold","observe","unobserve","imgUrl"],"sources":["C:/Users/neo/Desktop/veb/23.02.23/Blog/frontend/src/features/PostItemContent.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { FaVolumeUp, FaVolumeMute } from 'react-icons/fa';\r\nimport { useSelector } from 'react-redux';\r\nimport { FaPlay, FaPause } from 'react-icons/fa';\r\n\r\nexport const PostItemContent = ({ post }) => {\r\n    const user = useSelector((state) => state.auth.user);\r\n    const [isPlaying, setIsPlaying] = useState(false);\r\n    const [isMuted, setIsMuted] = useState(false);\r\n    const API_URL = process.env.REACT_APP_API_URL;\r\n\r\n    const videoRef = useRef(null);\r\n\r\n    const togglePlayPause = () => {\r\n        if (isPlaying) {\r\n            videoRef.current.pause();\r\n        } else {\r\n            videoRef.current.play();\r\n        }\r\n        setIsPlaying(!isPlaying);\r\n    };\r\n\r\n    const toggleMute = () => {\r\n        setIsMuted((prev) => !prev);\r\n        videoRef.current.muted = !isMuted;\r\n    };\r\n\r\n    const isVideo = (url) => {\r\n        const videoExtensions = ['.mp4', '.webm', '.ogg'];\r\n        return videoExtensions.some((ext) => url.endsWith(ext));\r\n    };\r\n\r\n    useEffect(() => {\r\n        const videoElement = videoRef.current;\r\n        if (!videoElement) return;\r\n\r\n        const observer = new IntersectionObserver(\r\n            (entries) => {\r\n                entries.forEach((entry) => {\r\n                    if (!entry.isIntersecting && !videoElement.paused) {\r\n                        videoElement.pause();\r\n                        setIsPlaying(false);\r\n                    }\r\n                });\r\n            },\r\n            { threshold: 0.5 } // 50% видео должно быть видно, чтобы считалось \"на экране\"\r\n        );\r\n\r\n        observer.observe(videoElement);\r\n\r\n        return () => {\r\n            observer.unobserve(videoElement);\r\n        };\r\n    }, []);\r\n\r\n    return (\r\n        <div className={`${post.imgUrl && isVideo(post.imgUrl)} transition-all`}>\r\n            {post.imgUrl && isVideo(post.imgUrl) ? (\r\n                <div className=\"relative group\">\r\n                    <video\r\n                        ref={videoRef}\r\n                        width=\"100%\"\r\n                        height=\"100%\"\r\n                        maxHeight=\"550px\"\r\n                        muted={isMuted}\r\n                        className='object-cover w-full'\r\n                        onLoadedData={() => {\r\n                            videoRef.current.play();\r\n                            setIsPlaying(true);\r\n                        }}\r\n                    >\r\n                        <source src={`${API_URL}/${post.imgUrl}`} type=\"video/mp4\" />\r\n                        Ваш браузер не поддерживает видео.\r\n                    </video>\r\n\r\n                    <div className=\"absolute inset-0 flex justify-center items-center bg-black bg-opacity-30 group-hover:flex hidden\">\r\n                        <button onClick={togglePlayPause} \r\n                        className=\"text-white opacity-50 hover:opacity-75 transition\"\r\n                        >\r\n                            {isPlaying ? (\r\n                                <FaPause className=\"max-md:w-8 max-md:h-8 w-20 h-20\" />\r\n                            ) : (\r\n                                <FaPlay className=\"max-md:w-8 max-md:h-8  w-20 h-20\" />\r\n                            )}\r\n                        </button>\r\n                    </div>\r\n                    <button\r\n                        onClick={toggleMute}\r\n                        className=\"absolute bottom-4 right-4 p-2 bg-black bg-opacity-50 rounded-full text-white\"\r\n                    >\r\n                        {isMuted ? <FaVolumeMute className=\"w-6 h-6\" /> : <FaVolumeUp className=\"w-6 h-6\" />}\r\n                    </button>\r\n                </div>\r\n            ) : (\r\n                <img\r\n                    src={`${API_URL}/${post.imgUrl}`}\r\n                    alt='Post content'\r\n                    className='object-cover w-full h-full max-md:max-h-[250px] max-h-[500px]'\r\n                />\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}