{"ast":null,"code":"// import React, { useEffect, useState, useCallback } from 'react'\n// import { useDispatch, useSelector } from 'react-redux'\n// import { useNavigate, useParams, Link } from 'react-router-dom'\n// import { toast } from 'react-toastify'\n// import { AiFillEye, AiOutlineMessage, AiTwotoneEdit, AiFillDelete, AiFillHeart, AiOutlineHeart } from 'react-icons/ai'\n// import Moment from 'react-moment'\n// import axios from '../utils/axios'\n// import { removePost } from '../redux/features/post/postSlice'\n// import { createComment, getPostComments } from '../redux/features/comment/commentSlice'\n// import { CommentItem } from '../components/CommentItem'\n// export const PostPage = () => {\n//     const [post, setPost] = useState(null)\n//     const [comment, setComment] = useState('')\n//     const { user } = useSelector((state) => state.auth)\n//     const { comments } = useSelector((state) => state.comment)\n//     const navigate = useNavigate()\n//     const params = useParams()\n//     const dispatch = useDispatch()\n//     const userId = user?._id  // Проверяем, существует ли user и его _id\n//     const isLiked = userId && post && post.likes && post.likes.includes(userId)\n//     const handleSubmit = () => {\n//         try {\n//             const postId = params.id\n//             dispatch(createComment({ postId, comment }))\n//             setComment('')\n//         } catch (error) {\n//             console.log(error)\n//         }\n//     }\n//     const fetchComments = useCallback(async () => {\n//         try {\n//             dispatch(getPostComments(params.id))\n//         } catch (error) {\n//             console.log(error)\n//         }\n//     }, [params.id, dispatch])\n//     const fetchPost = useCallback(async () => {\n//         const { data } = await axios.get(`/posts/${params.id}`)\n//         setPost(data)\n//     }, [params.id])\n//     useEffect(() => {\n//         fetchPost()\n//     }, [fetchPost])\n//     useEffect(() => {\n//         fetchComments()\n//     }, [fetchComments])\n//     const isVideo = (url) => {\n//         const videoExtensions = ['.mp4', '.webm', '.ogg']\n//         return videoExtensions.some((ext) => url.endsWith(ext))\n//     }\n//     if (!post) {\n//         return (\n//             <div className='text-xl text-center text-white py-10'>\n//                 Загрузка...\n//             </div>\n//         )\n//     }\n//     return (\n//         <div className='max-w-screen-xl mx-auto p-4'>\n//             <button className='bg-gray-700 text-xs text-white rounded-sm py-2 px-4 mb-6 hover:bg-gray-600 transition'>\n//                 <Link to='/' className='flex'>\n//                     Назад\n//                 </Link>\n//             </button>\n//             <div className='flex flex-col gap-12'>\n//                 <div className='md:w-2/3 mx-auto'>\n//                     <div className='bg-white rounded-lg shadow-lg p-6'>\n//                         <div className=\"flex justify-between items-center px-4 py-2\">\n//                             <div className='flex items-center gap-2'>\n//                                 <img\n//                                     src={post?.authorAvatar ? `http://localhost:3002/${post.authorAvatar}` : 'img/User-avatar.png'} \n//                                     alt=\"Author avatar\"\n//                                     className=\"w-10 h-10 rounded-full object-cover\"\n//                                 />\n//                                 <div className='text-sm font-semibold text-gray-800'>{post.username}</div>\n//                             </div>\n//                             <div>\n//                                 <Moment date={post.createdAt} format='D MMM YYYY' />\n//                             </div>\n//                         </div>\n//                         <div\n//                             className={\n//                                 post?.imgUrl\n//                                     ? 'rounded-sm h-80 mb-4 overflow-hidden'\n//                                     : 'rounded-sm h-48 mb-4'\n//                             }\n//                         >\n//                             {post?.imgUrl && (\n//                                 isVideo(post.imgUrl) ? (\n//                                     <video\n//                                         width=\"100%\"\n//                                         height=\"100%\"\n//                                         controls\n//                                         className='object-cover w-full h-full rounded-sm'\n//                                     >\n//                                         <source src={`http://localhost:3002/${post.imgUrl}`} type=\"video/mp4\" />\n//                                         Ваш браузер не поддерживает видео.\n//                                     </video>\n//                                 ) : (\n//                                     <img\n//                                         src={`http://localhost:3002/${post.imgUrl}`}\n//                                         alt='Post content'\n//                                         className='object-cover w-full h-full rounded-sm'\n//                                     />\n//                                 )\n//                             )}\n//                         </div>\n//                         {post.tags && post.tags.length > 0 && (\n//                             <div className='mb-2 flex flex-wrap gap-2'>\n//                                 {post.tags.map((tag, index) => (\n//                                     <span key={index} className='px-2 py-1 bg-gray-200 rounded-full text-sm text-gray-800'>\n//                                         #{tag}\n//                                     </span>\n//                                 ))}\n//                             </div>\n//                         )}\n//                         <div className='text-2xl font-semibold text-gray-900 mt-4'>\n//                             {post.title}\n//                         </div>\n//                         <p className='text-gray-700 mt-2 text-sm line-clamp-4'>\n//                             {post.text}\n//                         </p>\n//                         <div className='flex justify-between items-center mt-4'>\n//                             <div className='flex gap-6'>\n//                                 <button className='flex items-center gap-1'>\n//                                     {isLiked ? (\n//                                         <AiFillHeart className='text-red-500' />\n//                                     ) : (\n//                                         <AiOutlineHeart />\n//                                     )}\n//                                     <span>{post.likes.length}</span>\n//                                 </button>\n//                                 <button className='flex items-center text-gray-600 gap-1 hover:text-gray-800'>\n//                                     <AiFillEye />\n//                                     <span>{post.views}</span>\n//                                 </button>\n//                                 <button className='flex items-center text-gray-600 gap-1 hover:text-gray-800'>\n//                                     <AiOutlineMessage />\n//                                     <span>{post.comments?.length || 0}</span>\n//                                 </button>\n//                             </div>\n//                             {(user?._id === post.author || user?.username === 'Admin') && (\n//                                 <div className='flex gap-4'>\n//                                     {(user?._id === post.author || user?.username !== 'Admin') && (\n//                                         <Link\n//                                             to={`/${params.id}/edit`}\n//                                             className='flex items-center text-gray-600 hover:text-gray-800'\n//                                         >\n//                                             <AiTwotoneEdit />\n//                                         </Link>\n//                                     )}\n//                                     <button\n//                                         onClick={removePostHandler}\n//                                         className='flex items-center text-gray-600 hover:text-gray-800'\n//                                     >\n//                                         <AiFillDelete />\n//                                     </button>\n//                                 </div>\n//                             )}\n//                         </div>\n//                     </div>\n//                 </div>\n//                 <div className='w-full bg-gray-800 rounded-lg p-6 mx-auto'>\n//                     <form\n//                         className='flex gap-4 mb-4'\n//                         onSubmit={(e) => e.preventDefault()}\n//                     >\n//                         <input\n//                             type='text'\n//                             value={comment}\n//                             onChange={(e) => setComment(e.target.value)}\n//                             placeholder='Напишите комментарий...'\n//                             className='w-full rounded-sm bg-gray-600 border p-3 text-xs text-white placeholder:text-gray-400 focus:outline-none'\n//                         />\n//                         <button\n//                             type='submit'\n//                             onClick={handleSubmit}\n//                             className='bg-blue-600 text-white rounded-sm py-2 px-4 text-xs hover:bg-blue-700 transition'\n//                             disabled={!user}\n//                         >\n//                             Отправить\n//                         </button>\n//                     </form>\n//                     <div className='space-y-4'>\n//                         {comments?.map((cmt) => (\n//                             <CommentItem key={cmt._id} cmt={cmt} />\n//                         ))}\n//                     </div>\n//                 </div>\n//             </div>\n//         </div>\n//     )\n// }","map":{"version":3,"names":[],"sources":["C:/Users/neo/Desktop/veb/23.02.23/js projects/blog-platform/frontend/src/pages/PostPage.jsx"],"sourcesContent":["// import React, { useEffect, useState, useCallback } from 'react'\n// import { useDispatch, useSelector } from 'react-redux'\n// import { useNavigate, useParams, Link } from 'react-router-dom'\n// import { toast } from 'react-toastify'\n// import { AiFillEye, AiOutlineMessage, AiTwotoneEdit, AiFillDelete, AiFillHeart, AiOutlineHeart } from 'react-icons/ai'\n// import Moment from 'react-moment'\n// import axios from '../utils/axios'\n// import { removePost } from '../redux/features/post/postSlice'\n// import { createComment, getPostComments } from '../redux/features/comment/commentSlice'\n// import { CommentItem } from '../components/CommentItem'\n\n// export const PostPage = () => {\n//     const [post, setPost] = useState(null)\n//     const [comment, setComment] = useState('')\n\n//     const { user } = useSelector((state) => state.auth)\n//     const { comments } = useSelector((state) => state.comment)\n//     const navigate = useNavigate()\n//     const params = useParams()\n//     const dispatch = useDispatch()\n//     const userId = user?._id  // Проверяем, существует ли user и его _id\n//     const isLiked = userId && post && post.likes && post.likes.includes(userId)\n\n\n\n//     const handleSubmit = () => {\n//         try {\n//             const postId = params.id\n//             dispatch(createComment({ postId, comment }))\n//             setComment('')\n//         } catch (error) {\n//             console.log(error)\n//         }\n//     }\n\n//     const fetchComments = useCallback(async () => {\n//         try {\n//             dispatch(getPostComments(params.id))\n//         } catch (error) {\n//             console.log(error)\n//         }\n//     }, [params.id, dispatch])\n\n//     const fetchPost = useCallback(async () => {\n//         const { data } = await axios.get(`/posts/${params.id}`)\n//         setPost(data)\n//     }, [params.id])\n\n//     useEffect(() => {\n//         fetchPost()\n//     }, [fetchPost])\n\n//     useEffect(() => {\n//         fetchComments()\n//     }, [fetchComments])\n\n//     const isVideo = (url) => {\n//         const videoExtensions = ['.mp4', '.webm', '.ogg']\n//         return videoExtensions.some((ext) => url.endsWith(ext))\n//     }\n\n//     if (!post) {\n//         return (\n//             <div className='text-xl text-center text-white py-10'>\n//                 Загрузка...\n//             </div>\n//         )\n//     }\n\n//     return (\n//         <div className='max-w-screen-xl mx-auto p-4'>\n//             <button className='bg-gray-700 text-xs text-white rounded-sm py-2 px-4 mb-6 hover:bg-gray-600 transition'>\n//                 <Link to='/' className='flex'>\n//                     Назад\n//                 </Link>\n//             </button>\n\n//             <div className='flex flex-col gap-12'>\n//                 <div className='md:w-2/3 mx-auto'>\n//                     <div className='bg-white rounded-lg shadow-lg p-6'>\n//                         <div className=\"flex justify-between items-center px-4 py-2\">\n//                             <div className='flex items-center gap-2'>\n//                                 <img\n//                                     src={post?.authorAvatar ? `http://localhost:3002/${post.authorAvatar}` : 'img/User-avatar.png'} \n//                                     alt=\"Author avatar\"\n//                                     className=\"w-10 h-10 rounded-full object-cover\"\n//                                 />\n//                                 <div className='text-sm font-semibold text-gray-800'>{post.username}</div>\n//                             </div>\n//                             <div>\n//                                 <Moment date={post.createdAt} format='D MMM YYYY' />\n//                             </div>\n//                         </div>\n//                         <div\n//                             className={\n//                                 post?.imgUrl\n//                                     ? 'rounded-sm h-80 mb-4 overflow-hidden'\n//                                     : 'rounded-sm h-48 mb-4'\n//                             }\n//                         >\n//                             {post?.imgUrl && (\n//                                 isVideo(post.imgUrl) ? (\n//                                     <video\n//                                         width=\"100%\"\n//                                         height=\"100%\"\n//                                         controls\n//                                         className='object-cover w-full h-full rounded-sm'\n//                                     >\n//                                         <source src={`http://localhost:3002/${post.imgUrl}`} type=\"video/mp4\" />\n//                                         Ваш браузер не поддерживает видео.\n//                                     </video>\n//                                 ) : (\n//                                     <img\n//                                         src={`http://localhost:3002/${post.imgUrl}`}\n//                                         alt='Post content'\n//                                         className='object-cover w-full h-full rounded-sm'\n//                                     />\n//                                 )\n//                             )}\n//                         </div>\n//                         {post.tags && post.tags.length > 0 && (\n//                             <div className='mb-2 flex flex-wrap gap-2'>\n//                                 {post.tags.map((tag, index) => (\n//                                     <span key={index} className='px-2 py-1 bg-gray-200 rounded-full text-sm text-gray-800'>\n//                                         #{tag}\n//                                     </span>\n//                                 ))}\n//                             </div>\n//                         )}\n//                         <div className='text-2xl font-semibold text-gray-900 mt-4'>\n//                             {post.title}\n//                         </div>\n//                         <p className='text-gray-700 mt-2 text-sm line-clamp-4'>\n//                             {post.text}\n//                         </p>\n\n//                         <div className='flex justify-between items-center mt-4'>\n//                             <div className='flex gap-6'>\n//                                 <button className='flex items-center gap-1'>\n//                                     {isLiked ? (\n//                                         <AiFillHeart className='text-red-500' />\n//                                     ) : (\n//                                         <AiOutlineHeart />\n//                                     )}\n//                                     <span>{post.likes.length}</span>\n//                                 </button>\n//                                 <button className='flex items-center text-gray-600 gap-1 hover:text-gray-800'>\n//                                     <AiFillEye />\n//                                     <span>{post.views}</span>\n//                                 </button>\n//                                 <button className='flex items-center text-gray-600 gap-1 hover:text-gray-800'>\n//                                     <AiOutlineMessage />\n//                                     <span>{post.comments?.length || 0}</span>\n//                                 </button>\n//                             </div>\n\n//                             {(user?._id === post.author || user?.username === 'Admin') && (\n//                                 <div className='flex gap-4'>\n//                                     {(user?._id === post.author || user?.username !== 'Admin') && (\n//                                         <Link\n//                                             to={`/${params.id}/edit`}\n//                                             className='flex items-center text-gray-600 hover:text-gray-800'\n//                                         >\n//                                             <AiTwotoneEdit />\n//                                         </Link>\n//                                     )}\n//                                     <button\n//                                         onClick={removePostHandler}\n//                                         className='flex items-center text-gray-600 hover:text-gray-800'\n//                                     >\n//                                         <AiFillDelete />\n//                                     </button>\n//                                 </div>\n//                             )}\n//                         </div>\n//                     </div>\n//                 </div>\n\n//                 <div className='w-full bg-gray-800 rounded-lg p-6 mx-auto'>\n//                     <form\n//                         className='flex gap-4 mb-4'\n//                         onSubmit={(e) => e.preventDefault()}\n//                     >\n//                         <input\n//                             type='text'\n//                             value={comment}\n//                             onChange={(e) => setComment(e.target.value)}\n//                             placeholder='Напишите комментарий...'\n//                             className='w-full rounded-sm bg-gray-600 border p-3 text-xs text-white placeholder:text-gray-400 focus:outline-none'\n//                         />\n//                         <button\n//                             type='submit'\n//                             onClick={handleSubmit}\n//                             className='bg-blue-600 text-white rounded-sm py-2 px-4 text-xs hover:bg-blue-700 transition'\n//                             disabled={!user}\n//                         >\n//                             Отправить\n//                         </button>\n//                     </form>\n\n//                     <div className='space-y-4'>\n//                         {comments?.map((cmt) => (\n//                             <CommentItem key={cmt._id} cmt={cmt} />\n//                         ))}\n//                     </div>\n//                 </div>\n//             </div>\n//         </div>\n//     )\n// }\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"},"metadata":{},"sourceType":"module"}